{"version":3,"file":"static/js/UserInfoChange.89fe1d0c.chunk.js","mappings":"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","sources":["webpack://buysaleacademy/./src/hooks/useNotification.ts","webpack://buysaleacademy/./src/pages/ProfilePage/components/UserInfoChange/user-info.module.scss?9a2d","webpack://buysaleacademy/./src/pages/ProfilePage/helper/userInfoUpdate.ts","webpack://buysaleacademy/./src/pages/ProfilePage/components/UserInfoChange/UserInfoChange.tsx","webpack://buysaleacademy/./src/pages/ProfilePage/ui/FormBtn/form-btn.module.scss?f7e3","webpack://buysaleacademy/./src/pages/ProfilePage/ui/FormBtn/FormBtn.tsx","webpack://buysaleacademy/./src/pages/ProfilePage/ui/InputAndError/InputAneError.tsx"],"sourcesContent":["import { addNotification } from \"@src/pages/Container/store/action/notificationActions\";\nimport { useDispatch } from \"react-redux\";\nimport { useId } from \"react\";\nconst useNotification = () => {\n    const id = useId() + String(Date.now());\n    const dispatch = useDispatch();\n    return ({ type, body, }) => {\n        dispatch(addNotification({\n            id: id + String(Math.random()),\n            type,\n            body\n        }));\n    };\n};\nexport { useNotification };\n","// extracted by mini-css-extract-plugin\nexport default {\"profile_form\":\"pages-ProfilePage-components-UserInfoChange-user-info__profile_form\",\"profile_header\":\"pages-ProfilePage-components-UserInfoChange-user-info__profile_header\"};","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport axios from \"axios\";\n// const baseURL = 'http://localhost:8000';\nconst axiosConfig = {\n    method: 'patch',\n    // baseURL,\n    timeout: 5000,\n    withCredentials: true,\n};\nfunction userInfoUpdate(url, data) {\n    var _a, _b, _c;\n    return __awaiter(this, void 0, void 0, function* () {\n        if (typeof url === 'object') {\n            data = url;\n            url = 'api/user/update';\n        }\n        try {\n            const req = yield axios.patch(url, data, Object.assign({}, axiosConfig));\n            return {\n                name: 'Данные успешно изменены',\n                code: req.status\n            };\n        }\n        catch (err) {\n            const error = err;\n            if (((_a = error.response) === null || _a === void 0 ? void 0 : _a.status) === 401) {\n                return {\n                    name: 'Ошибка авторизации, пожалуйста, войдите в профиль снова',\n                    code: (_b = error.response) === null || _b === void 0 ? void 0 : _b.status,\n                };\n            }\n            else {\n                return {\n                    name: 'Произошла ошибка, повторите попытку позже',\n                    code: (_c = error.response) === null || _c === void 0 ? void 0 : _c.status,\n                };\n            }\n        }\n    });\n}\nexport { userInfoUpdate, };\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { FormProvider, useForm } from 'react-hook-form';\nimport InputAndError from '../../ui/InputAndError/InputAneError';\nimport FormBtn from '../../ui/FormBtn/FormBtn';\nimport style from './user-info.module.scss';\nimport { Suspense, useEffect } from 'react';\nimport { Navigate, useLoaderData, useNavigate } from 'react-router';\nimport LoadingSpinner from '@src/ui/LoadingSpinner/LoadingSpinner';\nimport { useNotification } from '@src/hooks/useNotification';\nimport { userInfoUpdate } from '../../helper/userInfoUpdate';\nconst UserInfoChange = () => {\n    const { userInfo } = useLoaderData();\n    const notification = useNotification();\n    const navigate = useNavigate();\n    useEffect(() => {\n        if ('code' in userInfo && userInfo.code === 401) {\n            notification({\n                type: 'error',\n                body: userInfo.name,\n            });\n        }\n        else if ('code' in userInfo) {\n            notification({\n                type: 'info',\n                body: userInfo.name,\n            });\n        }\n    }, []);\n    if ('code' in userInfo && userInfo.code === 401) {\n        return _jsx(Navigate, { to: '/login' });\n    }\n    else if ('code' in userInfo) {\n        return _jsx(Navigate, { to: '/user' });\n    }\n    const methods = useForm({\n        mode: 'all',\n        defaultValues: {\n            firstName: userInfo.first_name,\n            lastName: userInfo.second_name,\n            secondName: userInfo.middle_name,\n            email: userInfo.email,\n            telephone: userInfo.phone_number,\n        }\n    });\n    const { handleSubmit, } = methods;\n    const onSubmit = (data) => {\n        userInfoUpdate({\n            first_name: data.firstName,\n            second_name: data.lastName,\n            middle_name: data.secondName,\n            email: data.email,\n            phone_number: data.telephone,\n        })\n            .then((res) => {\n            if (res.code === 401) {\n                navigate('/login');\n            }\n        })\n            .catch((e) => console.log(e));\n    };\n    return (_jsx(Suspense, Object.assign({ fallback: _jsx(LoadingSpinner, {}) }, { children: _jsx(FormProvider, Object.assign({}, methods, { children: _jsxs(\"form\", Object.assign({ className: style.profile_form, onSubmit: handleSubmit(onSubmit) }, { children: [_jsx(\"h2\", Object.assign({ className: style.profile_header }, { children: \"\\u041B\\u0438\\u0447\\u043D\\u0430\\u044F \\u0438\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u044F\" })), _jsx(InputAndError, { label: 'Имя', type: 'text', name: 'firstName', required: 'Пожалуйста введите своё имя' }), _jsx(InputAndError, { label: 'Фамилия', type: 'text', name: 'lastName', required: 'Пожалуйста введите свою фамилию' }), _jsx(InputAndError, { label: 'Отчество', type: 'text', name: 'secondName' }), _jsx(\"h2\", Object.assign({ className: style.profile_header }, { children: \"\\u041A\\u043E\\u043D\\u0442\\u0430\\u043A\\u0442\\u043D\\u044B\\u0435 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435\" })), _jsx(InputAndError, { label: 'Номер телефона', type: 'tel', name: 'telephone', required: 'Пожалуйста введите свой номер телефона' }), _jsx(InputAndError, { label: 'Электронная почта', type: 'email', name: 'email', required: 'Пожалуйста введите свою почту' }), _jsx(FormBtn, { text: 'Зарегистрироваться' })] })) })) })));\n};\nexport default UserInfoChange;\n","// extracted by mini-css-extract-plugin\nexport default {\"form_btn\":\"pages-ProfilePage-ui-FormBtn-form-btn__form_btn\"};","import { jsx as _jsx } from \"react/jsx-runtime\";\nimport style from './form-btn.module.scss';\nconst FormBtn = ({ text }) => {\n    return (_jsx(\"input\", { value: text, type: 'submit', className: style.form_btn }));\n};\nexport default FormBtn;\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useFormContext } from 'react-hook-form';\nimport '@style/form-style.scss';\nconst reg = /./;\nconst InputAndError = ({ name, label, type, required, pattern = reg, message = '', }) => {\n    var _a;\n    const methods = useFormContext();\n    const { register, formState: { errors, } } = methods;\n    // const className = [style.input, isValid ? style.input_valid : style.input_invalid].join(' ');\n    return (_jsxs(\"div\", { children: [_jsxs(\"label\", { children: [label, _jsx(\"br\", {}), _jsx(\"input\", Object.assign({ type: type, className: 'input' }, register(name, {\n                        required,\n                        pattern: {\n                            value: pattern,\n                            message: message,\n                        }\n                    })))] }), _jsx(\"p\", Object.assign({ className: 'error_message' }, { children: (_a = errors[name]) === null || _a === void 0 ? void 0 : _a.message }))] }));\n};\nexport default InputAndError;\n"],"names":["useNotification","id","useId","String","Date","now","dispatch","useDispatch","_ref","type","body","addNotification","Math","random","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","axiosConfig","method","timeout","withCredentials","UserInfoChange","userInfo","useLoaderData","notification","navigate","useNavigate","useEffect","code","name","_jsx","Navigate","to","methods","useForm","mode","defaultValues","firstName","first_name","lastName","second_name","secondName","middle_name","email","telephone","phone_number","handleSubmit","Suspense","Object","assign","fallback","LoadingSpinner","children","FormProvider","_jsxs","className","style","onSubmit","data","url","_a","_b","_c","this","axios","status","err","error","response","userInfoUpdate","res","catch","console","log","InputAndError","label","required","FormBtn","text","reg","pattern","message","useFormContext","register","formState","errors"],"sourceRoot":""}